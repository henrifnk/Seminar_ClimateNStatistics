<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Statistical streamflow modelling | Climate And Statistics</title>
  <meta name="description" content="A Seminar about statistical methods in climate research in SS24." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Statistical streamflow modelling | Climate And Statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A Seminar about statistical methods in climate research in SS24." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Statistical streamflow modelling | Climate And Statistics" />
  
  <meta name="twitter:description" content="A Seminar about statistical methods in climate research in SS24." />
  

<meta name="author" content="Helmut Küchenhoff, Henri Funk" />


<meta name="date" content="2024-07-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lfe.html"/>
<link rel="next" href="he1.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Climate and Statistics</li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a>
<ul>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html#technical-setup"><i class="fa fa-check"></i>Technical Setup</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#intro-about-the-seminar-topic"><i class="fa fa-check"></i><b>1.1</b> Intro About the Seminar Topic</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#outline-of-the-booklet"><i class="fa fa-check"></i><b>1.2</b> Outline of the Booklet</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="iv.html"><a href="iv.html"><i class="fa fa-check"></i><b>2</b> Natural Variability by internal variability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="iv.html"><a href="iv.html#abstract"><i class="fa fa-check"></i><b>2.1</b> Abstract</a></li>
<li class="chapter" data-level="2.2" data-path="iv.html"><a href="iv.html#climate-model-ensemble"><i class="fa fa-check"></i><b>2.2</b> Climate Model Ensemble</a></li>
<li class="chapter" data-level="2.3" data-path="iv.html"><a href="iv.html#internal-variability"><i class="fa fa-check"></i><b>2.3</b> Internal Variability</a></li>
<li class="chapter" data-level="2.4" data-path="iv.html"><a href="iv.html#introduction-to-climate-modelling-and-climate-variability"><i class="fa fa-check"></i><b>2.4</b> 1. Introduction to climate modelling and climate variability</a></li>
<li class="chapter" data-level="2.5" data-path="iv.html"><a href="iv.html#basics-of-climate-models"><i class="fa fa-check"></i><b>2.5</b> 1.1 Basics of climate models</a></li>
<li class="chapter" data-level="2.6" data-path="iv.html"><a href="iv.html#types-of-climate-models-a-comparison"><i class="fa fa-check"></i><b>2.6</b> 1.2 Types of climate models: A comparison</a></li>
<li class="chapter" data-level="2.7" data-path="iv.html"><a href="iv.html#introduction-to-climate-model-ensembles"><i class="fa fa-check"></i><b>2.7</b> 2. Introduction to climate model ensembles</a></li>
<li class="chapter" data-level="2.8" data-path="iv.html"><a href="iv.html#definition-and-meaning-of-climate-model-ensembles"><i class="fa fa-check"></i><b>2.8</b> 2.1 Definition and meaning of climate model ensembles</a></li>
<li class="chapter" data-level="2.9" data-path="iv.html"><a href="iv.html#methods-for-calculating-climate-model-ensembles"><i class="fa fa-check"></i><b>2.9</b> 2.2 Methods for calculating climate model ensembles</a></li>
<li class="chapter" data-level="2.10" data-path="iv.html"><a href="iv.html#example-of-a-climate-model-ensemble"><i class="fa fa-check"></i><b>2.10</b> 2.3 Example of a climate model ensemble</a></li>
<li class="chapter" data-level="2.11" data-path="iv.html"><a href="iv.html#internal-variability-in-the-climate-system"><i class="fa fa-check"></i><b>2.11</b> 3. Internal variability in the climate system</a></li>
<li class="chapter" data-level="2.12" data-path="iv.html"><a href="iv.html#definition-and-causes-of-internal-variability"><i class="fa fa-check"></i><b>2.12</b> 3.1 Definition and causes of internal variability</a></li>
<li class="chapter" data-level="2.13" data-path="iv.html"><a href="iv.html#effects-of-internal-variability-on-climate-projections"><i class="fa fa-check"></i><b>2.13</b> 3.2 Effects of internal variability on climate projections</a></li>
<li class="chapter" data-level="2.14" data-path="iv.html"><a href="iv.html#application-and-meaning-of-climate-model-ensembles-in-research"><i class="fa fa-check"></i><b>2.14</b> 4. Application and meaning of climate model ensembles in research</a></li>
<li class="chapter" data-level="2.15" data-path="iv.html"><a href="iv.html#use-of-climate-model-ensembles-for-robust-climate-predictions"><i class="fa fa-check"></i><b>2.15</b> 4.1 Use of climate model ensembles for robust climate predictions</a></li>
<li class="chapter" data-level="2.16" data-path="iv.html"><a href="iv.html#application-examples-regional-and-seasonal-climate-trends"><i class="fa fa-check"></i><b>2.16</b> 4.2 Application examples: regional and seasonal climate trends</a></li>
<li class="chapter" data-level="2.17" data-path="iv.html"><a href="iv.html#conclusion"><i class="fa fa-check"></i><b>2.17</b> 5. Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spei.html"><a href="spei.html"><i class="fa fa-check"></i><b>3</b> Standard Precipitation Evapotranspiration Index</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spei.html"><a href="spei.html#definition"><i class="fa fa-check"></i><b>3.1</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ce.html"><a href="ce.html"><i class="fa fa-check"></i><b>4</b> Compound events</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ce.html"><a href="ce.html#example-hot-and-dry-events"><i class="fa fa-check"></i><b>4.1</b> Example: Hot and Dry Events</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ac.html"><a href="ac.html"><i class="fa fa-check"></i><b>5</b> Assymetric bivariate Copulas for compounds</a></li>
<li class="chapter" data-level="6" data-path="nao.html"><a href="nao.html"><i class="fa fa-check"></i><b>6</b> Teleconnections North Atlantic Oscillation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nao.html"><a href="nao.html#abstract-1"><i class="fa fa-check"></i><b>6.1</b> Abstract</a></li>
<li class="chapter" data-level="6.2" data-path="nao.html"><a href="nao.html#introduction-1"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="nao.html"><a href="nao.html#the-spatial-and-temporal-structure-of-the-nao"><i class="fa fa-check"></i><b>6.3</b> The spatial and temporal structure of the NAO</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="nao.html"><a href="nao.html#data"><i class="fa fa-check"></i><b>6.3.1</b> Data</a></li>
<li class="chapter" data-level="6.3.2" data-path="nao.html"><a href="nao.html#one-point-correlation-maps"><i class="fa fa-check"></i><b>6.3.2</b> One-point correlation maps</a></li>
<li class="chapter" data-level="6.3.3" data-path="nao.html"><a href="nao.html#eof-analysis"><i class="fa fa-check"></i><b>6.3.3</b> EOF Analysis</a></li>
<li class="chapter" data-level="6.3.4" data-path="nao.html"><a href="nao.html#cluster-analysis"><i class="fa fa-check"></i><b>6.3.4</b> Cluster Analysis</a></li>
<li class="chapter" data-level="6.3.5" data-path="nao.html"><a href="nao.html#nao-positive-and-negative-index"><i class="fa fa-check"></i><b>6.3.5</b> NAO positive and negative Index</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="nao.html"><a href="nao.html#the-implications-of-the-north-atlantic-oscillation"><i class="fa fa-check"></i><b>6.4</b> The Implications of the North Atlantic Oscillation</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="nao.html"><a href="nao.html#temperature-wind-speed-and-direction"><i class="fa fa-check"></i><b>6.4.1</b> Temperature, wind speed and direction</a></li>
<li class="chapter" data-level="6.4.2" data-path="nao.html"><a href="nao.html#storm-and-precipitation"><i class="fa fa-check"></i><b>6.4.2</b> Storm and precipitation</a></li>
<li class="chapter" data-level="6.4.3" data-path="nao.html"><a href="nao.html#ocean-and-sea-ice"><i class="fa fa-check"></i><b>6.4.3</b> Ocean and Sea Ice</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="nao.html"><a href="nao.html#conclusion-1"><i class="fa fa-check"></i><b>6.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lfe.html"><a href="lfe.html"><i class="fa fa-check"></i><b>7</b> Low Flow Events</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lfe.html"><a href="lfe.html#concept-of-extremeness-by-return-periods"><i class="fa fa-check"></i><b>7.1</b> Concept of Extremeness by Return Periods</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sm.html"><a href="sm.html"><i class="fa fa-check"></i><b>8</b> Statistical streamflow modelling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sm.html"><a href="sm.html#abstract-2"><i class="fa fa-check"></i><b>8.1</b> Abstract</a></li>
<li class="chapter" data-level="8.2" data-path="sm.html"><a href="sm.html#introduction-2"><i class="fa fa-check"></i><b>8.2</b> Introduction</a></li>
<li class="chapter" data-level="8.3" data-path="sm.html"><a href="sm.html#data-1"><i class="fa fa-check"></i><b>8.3</b> Data</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="sm.html"><a href="sm.html#preperation"><i class="fa fa-check"></i><b>8.3.1</b> Preperation</a></li>
<li class="chapter" data-level="8.3.2" data-path="sm.html"><a href="sm.html#preprocessing"><i class="fa fa-check"></i><b>8.3.2</b> Preprocessing</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sm.html"><a href="sm.html#models"><i class="fa fa-check"></i><b>8.4</b> Models</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sm.html"><a href="sm.html#lstm"><i class="fa fa-check"></i><b>8.4.1</b> LSTM</a></li>
<li class="chapter" data-level="8.4.2" data-path="sm.html"><a href="sm.html#temporal-fusion-transformer"><i class="fa fa-check"></i><b>8.4.2</b> Temporal Fusion Transformer</a></li>
<li class="chapter" data-level="8.4.3" data-path="sm.html"><a href="sm.html#kling-gupta-efficiency"><i class="fa fa-check"></i><b>8.4.3</b> Kling Gupta Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sm.html"><a href="sm.html#results"><i class="fa fa-check"></i><b>8.5</b> Results</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="sm.html"><a href="sm.html#training-setup"><i class="fa fa-check"></i><b>8.5.1</b> Training Setup</a></li>
<li class="chapter" data-level="8.5.2" data-path="sm.html"><a href="sm.html#results-1"><i class="fa fa-check"></i><b>8.5.2</b> Results</a></li>
<li class="chapter" data-level="8.5.3" data-path="sm.html"><a href="sm.html#feature-importance"><i class="fa fa-check"></i><b>8.5.3</b> Feature Importance</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="sm.html"><a href="sm.html#conclusion-2"><i class="fa fa-check"></i><b>8.6</b> Conclusion</a></li>
<li class="chapter" data-level="8.7" data-path="sm.html"><a href="sm.html#outlook"><i class="fa fa-check"></i><b>8.7</b> Outlook</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="he1.html"><a href="he1.html"><i class="fa fa-check"></i><b>9</b> The Lancet Report 2023</a>
<ul>
<li class="chapter" data-level="9.1" data-path="he1.html"><a href="he1.html#introduction-3"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="he1.html"><a href="he1.html#background"><i class="fa fa-check"></i><b>9.2</b> Background</a></li>
<li class="chapter" data-level="9.3" data-path="he1.html"><a href="he1.html#selected-indicators"><i class="fa fa-check"></i><b>9.3</b> Selected Indicators</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="he1.html"><a href="he1.html#indicator-1.1.2-exposure-of-vulnerable-populations-to-heatwaves"><i class="fa fa-check"></i><b>9.3.1</b> Indicator 1.1.2: Exposure of vulnerable populations to heatwaves</a></li>
<li class="chapter" data-level="9.3.2" data-path="he1.html"><a href="he1.html#indicator-1.1.5-heat-related-mortality"><i class="fa fa-check"></i><b>9.3.2</b> Indicator 1.1.5: Heat-related mortality</a></li>
<li class="chapter" data-level="9.3.3" data-path="he1.html"><a href="he1.html#indicator-1.4-food-insecurity-and-undernutrition"><i class="fa fa-check"></i><b>9.3.3</b> Indicator 1.4: Food insecurity and undernutrition</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="he1.html"><a href="he1.html#discussion"><i class="fa fa-check"></i><b>9.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="he2.html"><a href="he2.html"><i class="fa fa-check"></i><b>10</b> Epidemiologic studies on the heat effects</a></li>
<li class="chapter" data-level="11" data-path="he3.html"><a href="he3.html"><i class="fa fa-check"></i><b>11</b> Controversial issue : heat and humidity</a>
<ul>
<li class="chapter" data-level="11.1" data-path="he3.html"><a href="he3.html#abstract-3"><i class="fa fa-check"></i><b>11.1</b> Abstract</a></li>
<li class="chapter" data-level="11.2" data-path="he3.html"><a href="he3.html#introduction-4"><i class="fa fa-check"></i><b>11.2</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="he3.html"><a href="he3.html#background-1"><i class="fa fa-check"></i><b>11.2.1</b> Background</a></li>
<li class="chapter" data-level="11.2.2" data-path="he3.html"><a href="he3.html#epidemiological-studies"><i class="fa fa-check"></i><b>11.2.2</b> Epidemiological Studies</a></li>
<li class="chapter" data-level="11.2.3" data-path="he3.html"><a href="he3.html#physiological-knowledge"><i class="fa fa-check"></i><b>11.2.3</b> Physiological knowledge</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="he3.html"><a href="he3.html#heat-and-humidity-in-studies"><i class="fa fa-check"></i><b>11.3</b> Heat and Humidity in Studies</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="he3.html"><a href="he3.html#humidity-definitions"><i class="fa fa-check"></i><b>11.3.1</b> Humidity definitions</a></li>
<li class="chapter" data-level="11.3.2" data-path="he3.html"><a href="he3.html#composite-indicators"><i class="fa fa-check"></i><b>11.3.2</b> Composite Indicators</a></li>
<li class="chapter" data-level="11.3.3" data-path="he3.html"><a href="he3.html#confounder"><i class="fa fa-check"></i><b>11.3.3</b> Confounder</a></li>
<li class="chapter" data-level="11.3.4" data-path="he3.html"><a href="he3.html#effect-modification-and-interaction"><i class="fa fa-check"></i><b>11.3.4</b> Effect Modification and Interaction</a></li>
<li class="chapter" data-level="11.3.5" data-path="he3.html"><a href="he3.html#data-limitations"><i class="fa fa-check"></i><b>11.3.5</b> Data Limitations</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="he3.html"><a href="he3.html#examples"><i class="fa fa-check"></i><b>11.4</b> Examples</a></li>
<li class="chapter" data-level="11.5" data-path="he3.html"><a href="he3.html#discussion-1"><i class="fa fa-check"></i><b>11.5</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="he4.html"><a href="he4.html"><i class="fa fa-check"></i><b>12</b> Risk Projections</a></li>
<li class="chapter" data-level="13" data-path="menh3.html"><a href="menh3.html"><i class="fa fa-check"></i><b>13</b> Climate Crisis and Mental Health</a>
<ul>
<li class="chapter" data-level="13.1" data-path="menh3.html"><a href="menh3.html#introduction-5"><i class="fa fa-check"></i><b>13.1</b> 1. Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="menh3.html"><a href="menh3.html#challenges-of-quantifying-climate-change-impact-on-mental-health"><i class="fa fa-check"></i><b>13.2</b> 2. Challenges of Quantifying Climate Change Impact on Mental Health</a></li>
<li class="chapter" data-level="13.3" data-path="menh3.html"><a href="menh3.html#data-sources-and-methods-used-to-investigate-climate-change-impact"><i class="fa fa-check"></i><b>13.3</b> 3. Data Sources and Methods Used to Investigate Climate Change Impact</a></li>
<li class="chapter" data-level="13.4" data-path="menh3.html"><a href="menh3.html#the-impact-of-hurricanes-on-posttraumatic-stress-disorder-ptsd"><i class="fa fa-check"></i><b>13.4</b> 4. The Impact of Hurricanes on Posttraumatic Stress Disorder (PTSD)</a></li>
<li class="chapter" data-level="13.5" data-path="menh3.html"><a href="menh3.html#adaption-and-mitigation-strategies"><i class="fa fa-check"></i><b>13.5</b> 5. Adaption and Mitigation Strategies</a></li>
<li class="chapter" data-level="13.6" data-path="menh3.html"><a href="menh3.html#conclusion-3"><i class="fa fa-check"></i><b>13.6</b> 6. Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
<li class="chapter" data-level="15" data-path="open-issue.html"><a href="open-issue.html"><i class="fa fa-check"></i><b>15</b> Open issue</a></li>
<li class="chapter" data-level="16" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>16</b> Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Climate And Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sm" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Statistical streamflow modelling<a href="sm.html#sm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Author: Lennart Marx</em></p>
<p><em>Supervisor: Henri Funk</em></p>
<p><em>Degree: Master</em></p>
<div id="abstract-2" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Abstract<a href="sm.html#abstract-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This study evaluates and compares the performance of Long Short-Term Memory (LSTM) networks and Temporal Fusion Transformers (TFT) in forecasting streamflows for up to seven day ahead forecasts, using historical streamflow data alongside precipitation and temperature as covariates. Freely available data published by the bavarian hydrological authority from the Regen river in Bavaria, Germany, was used in conjunction with meteorological data from the ERA5 reanalysis dataset. River basins are defined via the HydroRIVERS and HydroBASINS dataset to obtain the area over which precipitation is aggregated. Results indicate that while both models face challenges in predicting extreme values, TFT maintains more consistent accuracy over longer forecast horizons while pure LSTM model’s predictions decline sharply in performance with increasing lead times.</p>
</div>
<div id="introduction-2" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Introduction<a href="sm.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Streamflow forecasting plays a crucial role in water resource management, particularly in flood prediction. As climate change intensifies extreme weather events and alters precipitation patterns, accurate streamflow forecasts have become increasingly important for mitigating flood risks by providing information about the timing and magnitude of potential flood events.This knowledge enables authorities to implement timely flood control measures, operate reservoirs effectively, and issue early warnings to vulnerable communities. As flooding remains one of the most common and destructive natural disasters, especially in developing countries, improved forecasting capabilities can significantly reduce the human and economic toll of these events. (<span class="citation">Nearing et al. (<a href="#ref-Nearing2024">2024</a>)</span>)</p>
<p>Hydropower is the dominant source of renewable energy, accounting for 16% of the world’s electricity output and 62% of renewable electricity generation (<span class="citation">Lee et al. (<a href="#ref-hess-26-2431-2022">2022</a>)</span>). Precise streamflow predictions can be beneficial in optimizing reservoir operations. <span class="citation">Lee et al. (<a href="#ref-hess-26-2431-2022">2022</a>)</span> show that this is the case for 94% of all analyzed dams dependent on forecasting ability and reservoir characteristics.</p>
<p>A streamflow refers to the flow of water in rivers, streams or other water bodies, originating from precipitation, melting snow, and groundwater discharge. It is typically measured in cubic meters per second (m³/s).</p>
<p>In recent years, machine learning techniques have emerged as powerful tools for forecasting in various domains, including hydrology. Traditional hydrological models often rely on extensive datasets and intricate physical parameters, which can be challenging to obtain and process. In contrast, machine learning models such as Long Short-Term Memory (LSTM) networks offer an alternative approach by learning patterns directly from historical data.</p>
<p>This study aims to evaluate and compare the performance of LSTM and TFT models in forecasting streamflows up to seven days ahead. By incorporating precipitation and temperature as future known covariates alongside historical streamflow data, this work seeks to determine the effectiveness of these models in predicting streamflows.</p>
</div>
<div id="data-1" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Data<a href="sm.html#data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="preperation" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Preperation<a href="sm.html#preperation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The streamflow data is gathered from the bavarian hydrology authority (GKD). They provide freely accessible data on most water bodies in Bavaria <span class="citation">Bayerisches Landesamt für Umwelt, Gewässerkundlicher Dienst Bayern (<a href="#ref-bayerisches_landesamt">2024</a>)</span>. Focusing on rivers of medium size where the entire length of the river is located inside of the state of Bavaria, the river Regen positioned north/east of the city of Regensburg was chosen as a bases for this study. The GKD has data on 21 streamflow gauging stations located at the Regen or any of its tributary rivers. For the Regen river, data between 2014 and 2024 is available with daily measurements on the streamflows including the coordinates of the the gauging station. This study focused on the 15207507 Marienthal gauging station that was located closest to the final outflow towards the Danube river within the city of Regensburg. Utilizing the HydroRIVERS dataset, which contains the shapes of rivers all over the world, it was possible the acquire the shape of the Regen along with its geolocation as shown in figure <a href="sm.html#fig:regen-shape">8.1</a> <span class="citation">Lehner, Verdin, and Jarvis (<a href="#ref-lehner">2008</a>)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:regen-shape"></span>
<img src="work/07-hydroLSTM/images/regen_stations.png" alt="Streamflow gauging stations that provide there measurements at the GKD along the Regen river (adapted from @OpenStreetMap)" width="70%" />
<p class="caption">
FIGURE 8.1: Streamflow gauging stations that provide there measurements at the GKD along the Regen river (adapted from <span class="citation">OpenStreetMap contributors (<a href="#ref-OpenStreetMap">2017</a>)</span>)
</p>
</div>
<p>A catchment also known as a drainage basin or watershed, is an area of land where all precipitation collects and drains off into a common outlet, such as a river, bay, or other body of water. The boundaries of a catchment are defined by the highest points of land around the drainage area, often referred to as the drainage divide. These catchment areas will later be used to determine the variables for precipitation that are used to forecast the streamflows of the river. Taking advantage of the HydroBASINS dataset, that contains the shapes of basins all over the world in different resolutions <span class="citation">Lehner, Verdin, and Jarvis (<a href="#ref-lehner">2008</a>)</span>. With the software QGIS a geoinformation system (GIS) all basins were chosen that completely contain the river Regen shape, which led to the 19 defined catchments that can be seen figure <a href="sm.html#fig:regen-catch">8.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:regen-catch"></span>
<img src="work/07-hydroLSTM/images/river_catch.png" alt="Catchments defined for the Regen river based on the HydroBASINS shapefile dataset (adapted from @OpenStreetMap)" width="70%" />
<p class="caption">
FIGURE 8.2: Catchments defined for the Regen river based on the HydroBASINS shapefile dataset (adapted from <span class="citation">OpenStreetMap contributors (<a href="#ref-OpenStreetMap">2017</a>)</span>)
</p>
</div>
<p>The ERA5 reanalysis dataset, contains a plethora of meteorological data in a of rasterized form. Each data cell contains information of when it occured, where it occured in the form of longitude and latitude coordinates as well as the information on a meteorological variables <span class="citation">H. Hersbach et al. (<a href="#ref-hersbach2023era5">2023a</a>)</span>. As proposed in <span class="citation">Sabzipour et al. (<a href="#ref-sabzipour">2023</a>)</span>, for this study the variables 2 meter temperature and total precipitation were selected around the area of the Regen and for the past 10 years.</p>
</div>
<div id="preprocessing" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Preprocessing<a href="sm.html#preprocessing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The measuring station 15207507 contained 1 missing value which was imputed by linear interpolation. As suggested in <span class="citation">Sabzipour et al. (<a href="#ref-sabzipour">2023</a>)</span> non centered moving average smoothing with a window size of 3 was applied to the streamflow data as can be seen in figure <a href="sm.html#fig:marien-stream">8.3</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:marien-stream"></span>
<img src="work/07-hydroLSTM/images/Moving_Average.png" alt="streamflows of the 15207507 Marienthal gauging stations before (blue) and after (orange) applying moving average smoothing" width="80%" />
<p class="caption">
FIGURE 8.3: streamflows of the 15207507 Marienthal gauging stations before (blue) and after (orange) applying moving average smoothing
</p>
</div>
<p>To combine the rasterized meteorological data from ERA5 with the streamflows of the Regen, it is necessary to only take precipitation into account that occurs within the defined catchments. To achieve this, a weighted average is calculated, where the weights are determined by the area size of the intersection between the raster cell of the meteorological data and the catchment. This can be seen in a schematic visualization in figure <a href="sm.html#fig:spatial-avg">8.4</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatial-avg"></span>
<img src="work/07-hydroLSTM/images/spatial_averaging.png" alt="schematic visualization of the spatial averaging performed for temperature and total precipitation during data preprocessing" width="80%" />
<p class="caption">
FIGURE 8.4: schematic visualization of the spatial averaging performed for temperature and total precipitation during data preprocessing
</p>
</div>
<span class="math display">\[ tp(\text{catch}_i) = \frac{1}{A(\text{catch}_i)} \sum_{cell_j \in \text{ERA5 raster}} \left( tp(\text{cell}_j) \cdot A(\text{catch}_i \cap \text{cell}_j) \right) \tag{1} \]</span>
<div style="text-align: center;">
<p>A : area<br />
catch : catchment<br />
cell : one cell in the raster data set of ERA5<br />
tp : total precipitation</p>
</div>
<p>Since the catchments are geospatially very close to each other, the different catchments are highly correlated to each other and therefore provide little variance (see Figure <a href="sm.html#fig:tp-corr">8.5</a>). To reduce the feature space for both variables temperature and precipitation, the mean is taken over all catchments. Finally to reduce the noise in the features a moving average of window size 3 was applied.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tp-corr"></span>
<img src="work/07-hydroLSTM/images/tp_correlation_table.png" alt="correlation table for total precipitation over all catchments" width="70%" />
<p class="caption">
FIGURE 8.5: correlation table for total precipitation over all catchments
</p>
</div>
</div>
</div>
<div id="models" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Models<a href="sm.html#models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lstm" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> LSTM<a href="sm.html#lstm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Long Short-Term Memory (LSTM) cell (figure <a href="sm.html#fig:lstm">8.6</a>) is a type of recurrent neural network (RNN) architecture designed to model temporal sequences and their long-range dependencies more accurately than traditional RNNs. LSTMs were introduced by Sepp Hochreiter and Jürgen Schmidhuber in 1997 to address the issue of vanishing and exploding gradients encountered in traditional RNNs <span class="citation">Hochreiter and Schmidhuber (<a href="#ref-hochreiter">1997</a>)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lstm"></span>
<img src="work/07-hydroLSTM/images/LSTM.png" alt="visualization of a LSTM cell at time step t (image adapted from @lstmimage)" width="70%" />
<p class="caption">
FIGURE 8.6: visualization of a LSTM cell at time step t (image adapted from <span class="citation">Chevalier (<a href="#ref-lstmimage">2023</a>)</span>)
</p>
</div>
<ol style="list-style-type: decimal">
<li><strong>Cell State (</strong><span class="math inline">\(C_t\)</span>): The internal memory of the cell, which can carry information across many time steps.</li>
<li><strong>Hidden State (</strong><span class="math inline">\(h_t\)</span>): The output of the LSTM cell at a given time step, also serving as the input to the next cell.</li>
<li><strong>Input Gate (</strong><span class="math inline">\(i_t\)</span>): Controls how much of the new information from the current input is used to update the cell state.</li>
<li><strong>Forget Gate (</strong><span class="math inline">\(f_t\)</span>): Decides how much of the past cell state should be forgotten.</li>
<li><strong>Output Gate (</strong><span class="math inline">\(o_t\)</span>): Determines the output of the LSTM cell based on the cell state.</li>
</ol>
<p>LSTMs are particularly well-suited for tasks that involve sequential data and temporal dependencies, such as:</p>
<ol style="list-style-type: decimal">
<li><strong>Natural Language Processing (NLP)</strong>:
<ul>
<li>Language modeling</li>
<li>Machine translation</li>
<li>Speech recognition</li>
</ul></li>
<li><strong>Time Series Forecasting</strong>:
<ul>
<li>Stock price prediction</li>
<li>Weather forecasting</li>
<li>Anomaly detection</li>
</ul></li>
</ol>
<p>Streamflow forecasting involves predicting the flow of water in rivers and streams over time, which is inherently a time-series problem with temporal dependencies influenced by various factors such as rainfall, snowmelt, and upstream water management. When used in an encoder decoder architecture LSTM-cells can also incorporate future known covariates such as weather forecasts. These specifications make LSTM-based architectures beneficial for modeling and forecasting streamflow data.</p>
</div>
<div id="temporal-fusion-transformer" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Temporal Fusion Transformer<a href="sm.html#temporal-fusion-transformer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Temporal Fusion Transformer (TFT) (figure <a href="sm.html#fig:tft">8.7</a>) is a neural network architecture specifically designed for multi-horizon time series forecasting. It combines the strengths of both recurrent and attention-based models, offering an advanced approach to handling complex time series data. The TFT was introduced by Bryan Lim et al. in 2019, aiming to provide interpretability and accuracy for forecasting tasks <span class="citation">Lim et al. (<a href="#ref-LIM20211748">2021</a>)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tft"></span>
<img src="work/07-hydroLSTM/images/TFT.png" alt="model architecture for the Temporal Fusion Transformer (image from @LIM20211748" width="80%" />
<p class="caption">
FIGURE 8.7: model architecture for the Temporal Fusion Transformer (image from <span class="citation">Lim et al. (<a href="#ref-LIM20211748">2021</a>)</span>
</p>
</div>
<p>A TFT consists of several key components:</p>
<ol style="list-style-type: decimal">
<li><strong>Temporal Processing</strong>:
<ul>
<li><strong>Local Processing with LSTMs</strong>: LSTMs are used to process local temporal dependencies within the time series.</li>
<li><strong>Multi-Head Attention</strong>: An attention mechanism to capture long-range dependencies across different time steps.</li>
</ul></li>
<li><strong>Variable Selection</strong>:
<ul>
<li><strong>Static Covariate Encoders</strong>: Handle static features that do not change over time (e.g., location-specific data).</li>
<li><strong>Temporal Covariate Encoders</strong>: Manage time-varying features (e.g., weather data, past values of the time series).</li>
</ul></li>
<li><strong>Gating Mechanisms</strong>:
<ul>
<li><strong>Gated Residual Network (GRN)</strong>: Ensures that only relevant information is passed through layers, improving the network’s efficiency and interpretability.</li>
<li><strong>Variable Selection Networks</strong>: Dynamically select relevant variables at each time step to enhance model performance and interpretability.</li>
</ul></li>
<li><strong>Multi-Horizon Forecasting</strong>:
<ul>
<li><strong>Sequence-to-Sequence Framework</strong>: Allows the TFT to generate forecasts for multiple future time steps simultaneously.</li>
</ul></li>
<li><strong>Interpretable Outputs</strong>:
<ul>
<li><strong>Attention Weights</strong>: Provide insights into which time steps and variables the model is focusing on, aiding interpretability.</li>
</ul></li>
</ol>
<p>The Temporal Fusion Transformer represents an advancement in time series forecasting, offering both high accuracy and interpretability. Its ability to capture complex dependencies, dynamically select relevant features, and provide insights into the decision-making process makes it a useful tool for streamflow forecasting.</p>
</div>
<div id="kling-gupta-efficiency" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Kling Gupta Efficiency<a href="sm.html#kling-gupta-efficiency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Kling-Gupta Efficiency (KGE) is a statistical metric used to evaluate the performance of hydrological models by comparing simulated data to observed data. Developed by Gupta et al. in 2009, the KGE addresses limitations found in traditional metrics such as the Nash-Sutcliffe Efficiency (NSE). The KGE decomposes the evaluation of model performance into three distinct components, providing a more comprehensive assessment. These components are correlation, bias, and variability, which help in understanding different aspects of the model’s accuracy.</p>
<p>The KGE is calculated using the following formula:</p>
<p><span class="math display">\[ \text{KGE} = 1 - \sqrt{(r - 1)^2 + (\alpha - 1)^2 + (\beta - 1)^2} \tag{2} \]</span></p>
<ul>
<li><p><span class="math inline">\(r\)</span> is the Pearson correlation coefficient between the simulated and observed values.</p></li>
<li><p><span class="math inline">\(\alpha\)</span> is the bias ratio, defined as the ratio of the mean of the simulated values to the mean of the observed values.</p></li>
<li><p><span class="math inline">\(\beta\)</span> is the standard deviation ratio, defined as the ratio of the standard deviation of the simulated values to the standard deviation of the observed values.</p></li>
</ul>
</div>
</div>
<div id="results" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Results<a href="sm.html#results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="training-setup" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Training Setup<a href="sm.html#training-setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The 2 different model architectures were trained using the historical streamflows as well as temperature and precipitation as covariates. Using an input sequence length of 364 days and an output lead time of up to 7 days. Temperature and precipitation can be used as future known values when considering weather forecasts. For example when trying to predict one step ahead forecast for the streamflow in addition to the past 364 days of precipitation values one can consider the precipitation forecast for the next day to get the best predictions possible.</p>
<p>The LSTM Model is run in an encoder decoder architecture, were the past 364 days are the input for an LSTM cell which returns a hidden state and an output as the encoder step. During the decoder step, the encoder hidden state is fed into the decoder LSTM together with the future known inputs. The model predicts incrementally in the sense that for example to predict a 3 step ahead forecast it firsts predicts 1 and 2 step forecast and uses both forecasts to then predict the 3 step prediction. Both model architectures were used from the pytorch-forecasting library. The models were retrained for the different lead times. The used hyperparameters for both models are shown in Table <a href="sm.html#tab:tab-hyperparams">8.1</a>.</p>
<p>The dataset is split into 70% train set, 15% validation set and 15% test set respectivell.</p>
<table style="width:100%;">
<caption><span id="tab:tab-hyperparams">TABLE 8.1: </span>Hyperparameter comparison between LSTM and TFT.</caption>
<colgroup>
<col width="42%" />
<col width="28%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Hyperparameter</th>
<th align="left">LSTM</th>
<th align="left">TFT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Batch Size</td>
<td align="left">128</td>
<td align="left">128</td>
</tr>
<tr class="even">
<td align="left">Epochs</td>
<td align="left">100</td>
<td align="left">80</td>
</tr>
<tr class="odd">
<td align="left">Hidden Size</td>
<td align="left">128</td>
<td align="left">128</td>
</tr>
<tr class="even">
<td align="left">Attention Head Size</td>
<td align="left">-</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">Learning Rate</td>
<td align="left">0.001</td>
<td align="left">0.003</td>
</tr>
<tr class="even">
<td align="left">Dropout</td>
<td align="left">0.2</td>
<td align="left">0.1</td>
</tr>
<tr class="odd">
<td align="left">Weight Decay</td>
<td align="left">0.001</td>
<td align="left">1e-04</td>
</tr>
<tr class="even">
<td align="left">Gradient Clipping</td>
<td align="left">0.1</td>
<td align="left">0.1</td>
</tr>
<tr class="odd">
<td align="left">Loss Function</td>
<td align="left">Mean Absolute Error</td>
<td align="left">Mean Absolute Error</td>
</tr>
<tr class="even">
<td align="left">Optimizer</td>
<td align="left">Adam</td>
<td align="left">Adam</td>
</tr>
<tr class="odd">
<td align="left">Reduce on Plateau Patience</td>
<td align="left">7</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">Time Varying Known Features</td>
<td align="left">t2m, tp</td>
<td align="left">t2m, tp</td>
</tr>
<tr class="odd">
<td align="left">Time Varying Unknown Features</td>
<td align="left">streamflow 15207507</td>
<td align="left">streamflow 15207507</td>
</tr>
</tbody>
</table>
</div>
<div id="results-1" class="section level3 hasAnchor" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> Results<a href="sm.html#results-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The models evaluated on the holdout test set show good performance for lead times of 1 and 2 days especially considering since the training and validation loss that is used is the MAE and not the KGE. The performance declines sharply for the LSTM model across the lead times while the decline for the TFT is more gradual as can be seen in Table <a href="sm.html#tab:tab-results">8.2</a>.</p>
<table>
<caption><span id="tab:tab-results">TABLE 8.2: </span>Performance comparison between TFT and LSTM models across different lead times on a holdout test set. Better performing model for each lead time in bold</caption>
<thead>
<tr class="header">
<th align="right">Lead.Time</th>
<th align="left">TFT.KGE</th>
<th align="left">LSTM.KGE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">0.8352</td>
<td align="left"><strong>0.9696</strong></td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">0.7103</td>
<td align="left"><strong>0.8821</strong></td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">0.6410</td>
<td align="left"><strong>0.6716</strong></td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left"><strong>0.6096</strong></td>
<td align="left">0.4943</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left"><strong>0.5901</strong></td>
<td align="left">0.4302</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left"><strong>0.5778</strong></td>
<td align="left">0.3312</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left"><strong>0.5717</strong></td>
<td align="left">0.3185</td>
</tr>
</tbody>
</table>
<p>Forecasting the peaks of the streamflows is challenging and neither model performs particularly well on this task. Especially when considering that the peaks were already drastically reduced due to the moving average smoothing of the target variable. The model routinely undershoots the observed true streamflows here shown for a lead time of 5 days for the LSTM Model and the TFT Model in figure <a href="sm.html#fig:lstm-pred">8.8</a> and in figure <a href="sm.html#fig:tft-pred">8.9</a> respectively. This behavior can be observed for all lead times except 1 and 2 days where the performance is reasonable even in the peaks.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lstm-pred"></span>
<img src="work/07-hydroLSTM/images/lag5_lstm.png" alt="LSTM predicted streamflows for a lead time of 5 days (orange) compared to the observed streamflows (blue)" width="80%" />
<p class="caption">
FIGURE 8.8: LSTM predicted streamflows for a lead time of 5 days (orange) compared to the observed streamflows (blue)
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tft-pred"></span>
<img src="work/07-hydroLSTM/images/lag5_tft.png" alt="TFT predicted streamflows for a lead time of 5 days (orange) compared to the observed streamflows (blue)" width="80%" />
<p class="caption">
FIGURE 8.9: TFT predicted streamflows for a lead time of 5 days (orange) compared to the observed streamflows (blue)
</p>
</div>
</div>
<div id="feature-importance" class="section level3 hasAnchor" number="8.5.3">
<h3><span class="header-section-number">8.5.3</span> Feature Importance<a href="sm.html#feature-importance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For an inspection of feature dependence it is possible to make use of the inbuilt function that the pytorch-forecasting library provides. The models show very similar behavior for both used covariates. As can be seen in <a href="sm.html#fig:tp-tft-imp">8.11</a> the TFT model observes a slightly stronger relationship between high total precipitation and large streamflows, but the plot for for both models has the expected shape, that high precipitation leads to high streamflows and vice versa.</p>
<p>In analyzing the relationship between t2m and streamflow, both graphs demonstrate a positive relationship. Specifically, the TFT dependence plot in Figure <a href="sm.html#fig:t2m-tft-imp">8.13</a> shows an increase up to approximately 280 K, beyond which the effect plateaus. Similarly, the LSTM model depicted in Figure <a href="sm.html#fig:t2m-lstm-imp">8.12</a> shows a more gradual increase, with the effect leveling off at higher mean temperatures of around 295 K.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tp-lstm-imp"></span>
<img src="work/07-hydroLSTM/images/mean_tp_feature_importance_lstm.png" alt="Feature dependence plot for mean total precipitation for a lead time 5 trained LSTM" width="70%" />
<p class="caption">
FIGURE 8.10: Feature dependence plot for mean total precipitation for a lead time 5 trained LSTM
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tp-tft-imp"></span>
<img src="work/07-hydroLSTM/images/mean_tp_feature_importance_tft.png" alt="Feature dependence plot for mean total precipitation for a lead time 5 trained TFT" width="70%" />
<p class="caption">
FIGURE 8.11: Feature dependence plot for mean total precipitation for a lead time 5 trained TFT
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:t2m-lstm-imp"></span>
<img src="work/07-hydroLSTM/images/mean_t2m_feature_importance_lstm.png" alt="Feature dependence plot for mean two meter temperature for a lead time 5 trained LSTM" width="70%" />
<p class="caption">
FIGURE 8.12: Feature dependence plot for mean two meter temperature for a lead time 5 trained LSTM
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:t2m-tft-imp"></span>
<img src="work/07-hydroLSTM/images/mean_t2m_feature_importance_tft.png" alt="Feature dependence plot for mean two meter temperature for a lead time 5 trained TFT" width="70%" />
<p class="caption">
FIGURE 8.13: Feature dependence plot for mean two meter temperature for a lead time 5 trained TFT
</p>
</div>
</div>
</div>
<div id="conclusion-2" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Conclusion<a href="sm.html#conclusion-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This study compares the performance of LSTM (Long Short-Term Memory) and Temporal Fusion Transformer (TFT) models in forecasting streamflows of the bavarian Regen river for up to seven days ahead, using precipitation and temperature as future known covariates alongside historical streamflow data. The data used was obtained from freely available data provided by the Bavarian hydrology authority and Copernicus Climate Project.</p>
<p>The findings indicate that both models exhibit limitations in predicting extreme values such as floods, with KGE (Kling-Gupta Efficiency) scores significantly lower than those reported in similar studies like <span class="citation">Sabzipour et al. (<a href="#ref-sabzipour">2023</a>)</span>, likely due to limited data amounts and the challenges inherent in modeling a river system instead of a reservoir. The results also demonstrate a clear difference in performance trends between the two models across different lead times.</p>
<p>Although the KGE was not used as the loss function in training the models. The LSTM’s observed KGE scores are high starting at 0.9696 for a one-day lead time, before dropping sharply to 0.3185 for a seven-day lead time. Conversely, the TFT model shows a more gradual decline, from 0.8352 at one day to 0.5717 at seven days, suggesting it maintains more consistent accuracy over longer forecast horizons.</p>
<p>Despite the sharper decline in performance for longer lead times, the LSTM model is notably less resource-dependent, making it a viable option for scenarios where computational resources are limited. However, attempts to forecast streamflows without future known meteorological variables were unsuccessful, underscoring the importance of these covariates in achieving accurate predictions.</p>
<p>While the moving average was applied here, it is not advised to use this tool for streamflow forecasting. By reducing the peaks in the target variable it artificially boosts the predictive abitlity of the model and forces the model to miss the peaks by an even larger margin. In a flood scenario even with a high KGE, the model would miss the exact streamflow value as it was trained on lower peaks and would underestimate the posed danger in the situation.</p>
</div>
<div id="outlook" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Outlook<a href="sm.html#outlook" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Implementing a robust hyper-parameter tuning routine is essential to optimize model performance. This process will require additional computational resources due to the complexity and extensive search space. Given the high dependency of hyper-parameters on lag, it might be necessary to tune hyper-parameters for each lead time separately.</p>
<p>To make the models more sensitive to extreme events such as floods, specialized loss functions could be employed or training a consecutive model that that specifically forecasts the peaks taking the first models predictions as inputs.</p>
<p>The ERA5 dataset used for obtaining meterological data in this study only provides a very coarse representation of the underlying variables. The use of down scaling techniques to obtain a finer grid than the one used in this study might be able to boost the accuracy of the model.</p>
<p>Another next step could be to test the models ability to generalize by training on multiple datasets from different rivers. Including static variables such as river basin properties and land use information can help in creating a more comprehensive model that can adapt to various river systems.</p>

</div>
</div>
<h3>References<a href="references-1.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bayerisches_landesamt" class="csl-entry">
Bayerisches Landesamt für Umwelt, Gewässerkundlicher Dienst Bayern. 2024. <span>“Runoff Data for Regen River.”</span>
</div>
<div id="ref-lstmimage" class="csl-entry">
Chevalier, Guillaume. 2023. <span>“LSTM Cell.”</span> <a href="https://creativecommons.org/licenses/by-sa/4.0" class="uri">https://creativecommons.org/licenses/by-sa/4.0</a>.
</div>
<div id="ref-hersbach2023era5" class="csl-entry">
Hersbach, H., B. Bell, P. Berrisford, G. Biavati, A. Horányi, J. Muñoz Sabater, J. Nicolas, et al. 2023a. <span>“ERA5 Hourly Data on Pressure Levels from 1940 to Present.”</span> Copernicus Climate Change Service (C3S) Climate Data Store (CDS). <a href="https://doi.org/10.24381/cds.bd0915c6">https://doi.org/10.24381/cds.bd0915c6</a>.
</div>
<div id="ref-hochreiter" class="csl-entry">
Hochreiter, Sepp, and Jürgen Schmidhuber. 1997. <span>“Long Short-Term Memory.”</span> <em>Neural Computation</em> 9 (December): 1735–80. <a href="https://doi.org/10.1162/neco.1997.9.8.1735">https://doi.org/10.1162/neco.1997.9.8.1735</a>.
</div>
<div id="ref-hess-26-2431-2022" class="csl-entry">
Lee, D., J. Y. Ng, S. Galelli, and P. Block. 2022. <span>“Unfolding the Relationship Between Seasonal Forecast Skill and Value in Hydropower Production: A Global Analysis.”</span> <em>Hydrology and Earth System Sciences</em> 26 (9): 2431–48. <a href="https://doi.org/10.5194/hess-26-2431-2022">https://doi.org/10.5194/hess-26-2431-2022</a>.
</div>
<div id="ref-lehner" class="csl-entry">
Lehner, Bernhard, Kristine Verdin, and Andy Jarvis. 2008. <span>“New Global Hydrography Derived from Spaceborne Elevation Data.”</span> <em>Eos, Transactions</em> 89 (10): 93–94.
</div>
<div id="ref-LIM20211748" class="csl-entry">
Lim, Bryan, Sercan Ö. Arık, Nicolas Loeff, and Tomas Pfister. 2021. <span>“Temporal Fusion Transformers for Interpretable Multi-Horizon Time Series Forecasting.”</span> <em>International Journal of Forecasting</em> 37 (4): 1748–64. https://doi.org/<a href="https://doi.org/10.1016/j.ijforecast.2021.03.012">https://doi.org/10.1016/j.ijforecast.2021.03.012</a>.
</div>
<div id="ref-Nearing2024" class="csl-entry">
Nearing, Grey S., Frederik Kratzert, Andrew K. Sampson, Craig S. Pelissier, Daniel Klotz, Jonathan M. Frame, Cristina Prieto, and Ashish Sharma. 2024. <span>“Global Prediction of Extreme Floods in Ungauged Watersheds.”</span> <em>Nature</em>. <a href="https://www.nature.com/articles/s41586-024-07145-1">https://www.nature.com/articles/s41586-024-07145-1</a>.
</div>
<div id="ref-OpenStreetMap" class="csl-entry">
OpenStreetMap contributors. 2017. <span>“<span class="nocase">Planet dump retrieved from https://planet.osm.org </span>.”</span><a href=" https://www.openstreetmap.org " class="uri"> https://www.openstreetmap.org</a>.
</div>
<div id="ref-sabzipour" class="csl-entry">
Sabzipour, Behmard, Richard Arsenault, Magali Troin, Jean-Luc Martel, François Brissette, Frédéric Brunet, and Juliane Mai. 2023. <span>“Comparing a Long Short-Term Memory (LSTM) Neural Network with a Physically-Based Hydrological Model for Streamflow Forecasting over a Canadian Catchment.”</span> <em>Journal of Hydrology</em> 627: 130380.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lfe.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="he1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
